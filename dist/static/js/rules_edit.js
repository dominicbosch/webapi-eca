var fOnLoad;fOnLoad=function(){var e,t,r;return document.title="Edit Rules",$("#pagetitle").text("{{{user.username}}}, edit your Rules!"),e=function(e){return function(t){var r;return 401===t.status?window.location.href="forge?page=edit_rules":($("#log_col").text(""),r=function(){var r,n;if(""===t.responseText)r="No Response from Server!";else try{n=JSON.parse(t.responseText),r=n.message}catch(o){}return $("#info").text(e+r),$("#info").attr("class","error")},setTimeout(r,500))}},t=function(){return $.post("/usercommand/get_rules").done(r).fail(e("Did not retrieve rules! "))},r=function(e){var t,r,n,o,l,a,i,s;for($("#tableRules tr").remove(),l=e.message,a=[],t=0,o=l.length;o>t;t++)i=l[t],s=$("<tr>"),r=$("<img>").attr("class","del").attr("title","Delete Rule").attr("src","images/red_cross_small.png"),s.append($("<td>").append(r)),r=$("<img>").attr("class","edit").attr("title","Edit Rule").attr("src","images/edit.png"),s.append($("<td>").append(r)),r=$("<img>").attr("class","log").attr("title","Show Rule Log").attr("src","images/logicon.png"),s.append($("<td>").append(r)),n=$("<div>").text(i),s.append($("<td>").append(n)),a.push($("#tableRules").append(s));return a},t(),$("#tableRules").on("click","img.del",function(){var r,n;return n=$("div",$(this).closest("tr")).text(),confirm("Do you really want to delete the rule '"+n+"'?")?($("#log_col").text(""),r={body:JSON.stringify({id:n})},$.post("/usercommand/delete_rule",r).done(t).fail(e("Could not delete rule! "))):void 0}),$("#tableRules").on("click","img.edit",function(){var e;return e=$("div",$(this).closest("tr")).text(),window.location.href="forge?page=forge_rule&id="+encodeURIComponent(e)}),$("#tableRules").on("click","img.log",function(){var t,r;return r=$("div",$(this).closest("tr")).text(),t={body:JSON.stringify({id:r})},$.post("/usercommand/get_rule_log",t).done(function(e){var t,n;return n=(new Date).toISOString(),t=e.message.replace(new RegExp("\n","g"),"<br>"),$("#log_col").html("<h3>"+r+" Log:</h3> <i>( updated UTC|"+n+" )</i><br/><br/>"+t)}).fail(e("Could not get rule log! "))})},window.addEventListener("load",fOnLoad,!0);